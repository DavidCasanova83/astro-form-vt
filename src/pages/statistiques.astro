---
import Header from '../components/Header.astro';
import "../styles/global.css";
---

<html lang="fr">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8" />
    <title>Statistiques</title>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
</head>
<body class="bg-gray-100 text-gray-800 h-screen flex items-center justify-center">
    <Header />
    <main class="container mx-auto p-6 max-w-2xl bg-white shadow-lg rounded-lg text-center"
        x-data="{ count: 0 }"
        x-init="fetch('/api/statistics')
                .then(response => response.json())
                .then(data => { if (data.success) count = data.count; })">
        <h1 class="text-3xl font-bold mb-4">Statistiques</h1>
        <p class="text-xl">Nombre de formulaires envoy√©s :</p>
        <p class="text-4xl font-bold text-blue-600 mt-2" x-text="count"></p>
    </main>
    <script>
      fetch('/api/getAllForms')
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            console.log("üìä Donn√©es r√©cup√©r√©es depuis DynamoDB :", data.data);
          } else {
            console.error("‚ùå Erreur lors de la r√©cup√©ration :", data.error);
          }
        })
        .catch(error => console.error("‚ö†Ô∏è Erreur de connexion √† l'API :", error));
    </script>    
</body>
</html>
